<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lymax Activity Tracker</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }
      body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 20px;
      }
      .container {
        max-width: 1400px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        padding: 40px;
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      }
      h1 {
        text-align: center;
        color: #2c3e50;
        margin-bottom: 10px;
        font-size: 2.5em;
      }
      .subtitle {
        text-align: center;
        color: #7f8c8d;
        margin-bottom: 30px;
        font-size: 1.1em;
      }
      .controls {
        display: flex;
        gap: 20px;
        margin-bottom: 30px;
        flex-wrap: wrap;
        align-items: center;
      }
      .control-group {
        display: flex;
        align-items: center;
        gap: 10px;
      }
      .control-group label {
        font-weight: 600;
        color: #2c3e50;
      }
      input[type='date'],
      select {
        padding: 10px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
      }
      .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
      }
      .stat-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 25px;
        border-radius: 15px;
        color: white;
        text-align: center;
      }
      .stat-card h3 {
        font-size: 1em;
        margin-bottom: 10px;
        opacity: 0.9;
      }
      .stat-card .number {
        font-size: 3em;
        font-weight: bold;
        margin: 10px 0;
      }
      .stat-card .label {
        font-size: 0.9em;
        opacity: 0.8;
      }
      .tabs {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
        border-bottom: 2px solid #e0e0e0;
      }
      .tab-button {
        padding: 15px 30px;
        border: none;
        background: none;
        cursor: pointer;
        font-size: 1.1em;
        font-weight: 600;
        color: #7f8c8d;
        border-bottom: 3px solid transparent;
        transition: all 0.3s;
      }
      .tab-button.active {
        color: #667eea;
        border-bottom-color: #667eea;
      }
      .team-section {
        display: none;
      }
      .team-section.active {
        display: block;
      }
      .form-group {
        display: flex;
        gap: 10px;
        margin-bottom: 20px;
      }
      .form-group input[type='text'] {
        flex: 1;
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
        font-size: 14px;
      }
      .form-group select {
        padding: 12px 15px;
        border: 2px solid #e0e0e0;
        border-radius: 8px;
      }
      .form-group button {
        padding: 12px 25px;
        background: #667eea;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: 600;
        transition: background 0.3s;
      }
      .form-group button:hover {
        background: #5568d3;
      }
      .tasks-list {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }
      .task-item {
        background: #f8f9fa;
        padding: 20px;
        border-radius: 10px;
        border-left: 4px solid #667eea;
      }
      .task-name {
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 5px;
      }
      .task-status {
        font-size: 0.9em;
        color: #7f8c8d;
      }
      .footer {
        margin-top: 30px;
        text-align: center;
        padding: 20px;
        background: #f8f9fa;
        border-radius: 10px;
        color: #27ae60;
        font-weight: 600;
      }
    </style>
  </head>
  <body>
    <div class="container">
    
            /* Task Card Styles */
      .tasks-list {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 15px;
        margin-top: 20px;
      }
      
      .task-card {
        background: white;
        border-radius: 10px;
        padding: 15px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        transition: transform 0.2s, box-shadow 0.2s;
      }
      
      .task-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      }
      
      .task-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 10px;
      }
      
      .task-employee {
        font-weight: 600;
        color: #2c3e50;
        font-size: 14px;
      }
      
      .task-priority {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 12px;
        font-weight: 600;
      }
      
      .priority-high {
        background: #ffe5e5;
        color: #d32f2f;
      }
      
      .priority-medium {
        background: #fff3e0;
        color: #f57c00;
      }
      
      .priority-low {
        background: #e8f5e9;
        color: #388e3c;
      }
      
      .task-body h4 {
        margin: 0 0 10px 0;
        color: #34495e;
        font-size: 16px;
      }
      
      .task-meta {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-top: 12px;
      }
      
      .task-status {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
      }
      
      .status-complete {
        background: #e8f5e9;
        color: #2e7d32;
      }
      
      .status-in-progress {
        background: #e3f2fd;
        color: #1976d2;
      }
      
      .status-started {
        background: #fff3e0;
        color: #f57c00;
      }
      
      .task-date {
        font-size: 12px;
        color: #7f8c8d;
      }
<h1>üìä Lymax Activity Tracking Dashboard</h1>
      <p class="subtitle">
        Real-time activity tracking for Sales, Operations, Marketing & Academic Leadership
      </p>

      <div class="controls">
        <div class="control-group">
          <label>Select Date:</label>
          <input type="date" id="dateInput" />
        </div>
        <div class="control-group">
          <label>Filter by Team:</label>
          <select id="teamFilter">
            <option value="All Teams">All Teams</option>
            <option value="Sales">Sales</option>
            <option value="Operations">Operations</option>
            <option value="Marketing">Marketing</option>
            <option value="Academic">Academic</option>
          </select>
        </div>
      </div>

      <div class="stats-grid">
        <div class="stat-card">
          <h3>üìã Total Tasks Today</h3>
          <div class="number" id="totalTasks">0</div>
          <div class="label">Across all teams</div>
        </div>
        <div class="stat-card">
          <h3>‚úÖ Completed Tasks</h3>
          <div class="number" id="completedTasks">0</div>
          <div class="label">
            <span id="completionRate">0%</span> completion rate
          </div>
        </div>
        <div class="stat-card">
          <h3>‚è≥ In Progress</h3>
          <div class="number" id="inProgressTasks">0</div>
          <div class="label">Active work items</div>
        </div>
      </div>

      <div class="tabs">
        <button class="tab-button active" onclick="showTab('sales')">
          üöÄ SALES
        </button>
        <button class="tab-button" onclick="showTab('operations')">
          ‚öôÔ∏è OPERATIONS
        </button>
        <button class="tab-button" onclick="showTab('marketing')">
          üì¢ MARKETING
        </button>
        <button class="tab-button" onclick="showTab('academic')">
          üéì ACADEMIC
        </button>
      </div>

      <div id="sales" class="team-section active">
        <h2>üöÄ Sales Team Daily Activities</h2>
        <div class="form-group">
          <input
            type="text"
            id="salesEmployee"
            placeholder="Employee Name"
          />
          <input
            type="text"
            id="salesTask"
            placeholder="Task name (e.g., Make 10 calls)"
          />
          <select id="salesStatus">
            <option>Started</option>
            <option>In Progress</option>
            <option>Complete</option>
          </select>
                    <select id="salesPriority">
                                  <option>Low</option>
                                  <option selected>Medium</option>
                                  <option>High</option>
                                </select>
                    <input
                                  type="date"
                                  id="salesDeadline"
                                  placeholder="Deadline"
                                />
          <button onclick="addTask('Sales')">+ Add Task</button>
        </div>
        <div id="salesTasks" class="tasks-list"></div>
      </div>

      <div id="operations" class="team-section">
        <h2>‚öôÔ∏è Operations Team Daily Activities</h2>
        <div class="form-group">
          <input
            type="text"
            id="operationsEmployee"
            placeholder="Employee Name"
          />
          <input type="text" id="operationsTask" placeholder="Task name" />
          <select id="operationsStatus">
            <option>Started</option>
            <option>In Progress</option>
            <option>Complete</option>
          </select>
                    <select id="operationsPriority">
                                  <option>Low</option>
                                  <option selected>Medium</option>
                                  <option>High</option>
                                </select>
                    <input type="date" id="operationsDeadline" placeholder="Deadline" />
          <button onclick="addTask('Operations')">+ Add Task</button>
        </div>
        <div id="operationsTasks" class="tasks-list"></div>
      </div>

      <div id="marketing" class="team-section">
        <h2>üì¢ Marketing Team Daily Activities</h2>
        <div class="form-group">
          <input
            type="text"
            id="marketingEmployee"
            placeholder="Employee Name"
          />
          <input type="text" id="marketingTask" placeholder="Task name" />
          <select id="marketingStatus">
            <option>Started</option>
            <option>In Progress</option>
            <option>Complete</option>
          </select>
                    <select id="marketingPriority">
                                  <option>Low</option>
                                  <option selected>Medium</option>
                                  <option>High</option>
                                </select>
                    <input type="date" id="marketingDeadline" placeholder="Deadline" />
          <button onclick="addTask('Marketing')">+ Add Task</button>
        </div>
        <div id="marketingTasks" class="tasks-list"></div>
      </div>

      <div id="academic" class="team-section">
        <h2>üéì Academic Team Daily Activities</h2>
        <div class="form-group">
          <input
            type="text"
            id="academicEmployee"
            placeholder="Employee Name"
          />
          <input type="text" id="academicTask" placeholder="Task name" />
          <select id="academicStatus">
            <option>Started</option>
            <option>In Progress</option>
            <option>Complete</option>
          </select>
                    <select id="academicPriority">
                                  <option>Low</option>
                                  <option selected>Medium</option>
                                  <option>High</option>
                                </select>
                    <input type="date" id="academicDeadline" placeholder="Deadline" />
          <button onclick="addTask('Academic')">+ Add Task</button>
        </div>
        <div id="academicTasks" class="tasks-list"></div>
      </div>

      <div class="footer">
        <p>‚úÖ Connected to Google Sheets | Data saves automatically</p>
      </div>
    </div>

    <script>
      const GOOGLE_SCRIPT_URL =
        'https://script.google.com/macros/s/AKfycbyq1KZjoCxwI7HkV_Q2iXwy_1d97lmaZRpNEQIBogeKU1yS472ShmxEOFbSlOIMb5BH-w/exec';

      // Set today's date
      document.getElementById('dateInput').valueAsDate = new Date();

      function showTab(team) {
        document
          .querySelectorAll('.team-section')
          .forEach((section) => section.classList.remove('active'));
        document
          .querySelectorAll('.tab-button')
          .forEach((button) => button.classList.remove('active'));
        document.getElementById(team).classList.add('active');
        event.target.classList.add('active');
      }

      async function addTask(team) {
        const employeeInput = document.getElementById(`${team.toLowerCase()}Employee`);
        const taskInput = document.getElementById(`${team.toLowerCase()}Task`);
        const statusSelect = document.getElementById(
          `${team.toLowerCase()}Status`
        );
        const employee = employeeInput.value.trim();
        const task = taskInput.value.trim();
        const status = statusSelect.value;
            const prioritySelect = document.getElementById(`${team.toLowerCase()}Priority`);
            const priority = prioritySelect.value;
            const deadlineInput = document.getElementById(`${team.toLowerCase()}Deadline`);
            const deadline = deadlineInput.value || 'No deadline';

        if (!employee) {
          alert('Please enter employee name');
          return;
        }

        if (!task) {
          alert('Please enter a task');
          return;
        }

        const date = document.getElementById('dateInput').value;
        const timestamp = new Date().toLocaleTimeString();

        try {
          await fetch(GOOGLE_SCRIPT_URL, {
            method: 'POST',
            mode: 'no-cors',
            headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ date, team, employee, task, status, priority, deadline, timestamp }),          });

    displayTask(team, employee, task, status, priority, deadline, timestamp);          employeeInput.value = '';
          taskInput.value = '';
          updateStats();
          showNotification('Task added successfully!');
        } catch (error) {
          console.error('Error:', error);
      displayTask(team, employee, task, status, priority, deadline, timestamp);          updateStats();
        }
                loadTasks(); // Refresh task display
      }

      function displayTask(team, employee, task, status, timestamp) {
        const tasksContainer = document.getElementById(
          `${team.toLowerCase()}Tasks`
        );
  function displayTask(team, employee, task, status, priority, deadline, timestamp) {        taskElement.className = 'task-item';
        taskElement.innerHTML = `
        <div class="task-name">${task}</div>
    <div class="task-status">Employee: ${employee} | Status: ${status} | Priority: <span style="color: ${priority === 'High' ? '#ff4444' : priority === 'Low' ? '#44ff44' : '#ffaa44'}">${priority}</span> | Deadline: ${deadline} | Added: ${timestamp}</div>      `;
        tasksContainer.insertBefore(taskElement, tasksContainer.firstChild);
      }

      function updateStats() {
        const allTasks = document.querySelectorAll('.task-item');
        const completed = Array.from(allTasks).filter((task) =>
          task.textContent.includes('Complete')
        ).length;
        const inProgress = Array.from(allTasks).filter((task) =>
          task.textContent.includes('In Progress')
        ).length;

        document.getElementById('totalTasks').textContent = allTasks.length;
        document.getElementById('completedTasks').textContent = completed;
        document.getElementById('inProgressTasks').textContent = inProgress;
        document.getElementById('completionRate').textContent =
          allTasks.length > 0
            ? Math.round((completed / allTasks.length) * 100) + '%'
            : '0%';
      }

      function showNotification(message) {
        const notification = document.createElement('div');
        notification.style.cssText = `
        position: fixed; top: 20px; right: 20px; background: #27ae60;
        color: white; padding: 15px 25px; border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 1000;
        animation: slideIn 0.5s;
      `;
        notification.textContent = message;
        document.body.appendChild(notification);
        setTimeout(() => {
          notification.style.animation = 'slideOut 0.5s';
          setTimeout(() => notification.remove(), 500);
        }, 3000);
      }

      const style = document.createElement('style');
      style.textContent = `
      @keyframes slideIn {
        from { transform: translateX(400px); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      @keyframes slideOut {
        from { transform: translateX(0); opacity: 1; }
        to { transform: translateX(400px); opacity: 0; }
      }
    `;
      document.head.appendChild(style);

      // Load and display tasks from Google Sheets
async function loadTasks() {
  try {
    const response = await fetch(GOOGLE_SCRIPT_URL);
    const data = await response.json();
    
    if (data.status === 'success' && data.tasks) {
      displayTasks(data.tasks);
      updateStatistics(data.tasks);
    }
  } catch (error) {
    console.error('Error loading tasks:', error);
  }
}

// Display tasks in their respective team sections
function displayTasks(tasks) {
  // Clear existing tasks
  document.querySelectorAll('.tasks-list').forEach(list => list.innerHTML = '');
  
  // Group tasks by team
  const tasksByTeam = {
    'Sales': [],
    'Operations': [],
    'Marketing': [],
    'Academic': []
  };
  
  tasks.forEach(task => {
    if (tasksByTeam[task.team]) {
      tasksByTeam[task.team].push(task);
    }
  });
  
  // Display tasks for each team
  Object.keys(tasksByTeam).forEach(team => {
    const taskListId = team.toLowerCase() + 'Tasks';
    const taskList = document.getElementById(taskListId);
    
    if (taskList) {
      tasksByTeam[team].forEach(task => {
        const taskCard = createTaskCard(task);
        taskList.appendChild(taskCard);
      });
    }
  });
}

// Create task card HTML
function createTaskCard(task) {
  const card = document.createElement('div');
  card.className = 'task-card';
  
  const statusClass = task.status === 'Complete' ? 'complete' : 
                      task.status === 'In Progress' ? 'in-progress' : 'started';
  const priorityClass = task.priority === 'High' ? 'high' : 
                        task.priority === 'Medium' ? 'medium' : 'low';
  
  card.innerHTML = `
    <div class="task-header">
      <span class="task-employee">${task.employee}</span>
      <span class="task-priority priority-${priorityClass}">${task.priority}</span>
    </div>
    <div class="task-body">
      <h4>${task.task}</h4>
      <div class="task-meta">
        <span class="task-status status-${statusClass}">${task.status}</span>
        <span class="task-date">${new Date(task.date).toLocaleDateString()}</span>
      </div>
    </div>
  `;
  
  return card;
}

// Update statistics based on tasks
function updateStatistics(tasks) {
  const today = new Date().toISOString().split('T')[0];
  const todayTasks = tasks.filter(task => {
    const taskDate = new Date(task.date).toISOString().split('T')[0];
    return taskDate === today;
  });
  
  const completedTasks = todayTasks.filter(task => task.status === 'Complete');
  const inProgressTasks = todayTasks.filter(task => task.status === 'In Progress');
  
  // Update totals
  document.getElementById('totalTasks').textContent = todayTasks.length;
  document.getElementById('completedTasks').textContent = completedTasks.length;
  document.getElementById('inProgressTasks').textContent = inProgressTasks.length;
  
  // Update completion rate
  const completionRate = todayTasks.length > 0 
    ? Math.round((completedTasks.length / todayTasks.length) * 100) 
    : 0;
  document.getElementById('completionRate').textContent = completionRate + '%';
}

// Call loadTasks when page loads
window.addEventListener('DOMContentLoaded', () => {
  loadTasks();
  // Refresh tasks every 30 seconds
  setInterval(loadTasks, 30000);
});
    </script>
  </body>
</html>






